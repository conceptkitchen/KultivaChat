INFO:werkzeug:127.0.0.1 - - [29/May/2025 18:32:51] "POST /api/chat HTTP/1.1" 200 -
INFO:main_2:Received user message for Gemini (genai.Client): show me data from OUT_FACT_ORDERS_5_KAPWA_GARDENS
INFO:main_2:Created Gemini chat session with initial history. Sending user message: 'show me data from OUT_FACT_ORDERS_5_KAPWA_GARDENS'
INFO:google_genai.models:AFC is enabled with max remote calls: 10.
INFO:httpx:HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent "HTTP/1.1 200 OK"
INFO:google_genai.models:AFC remote call 1 is done.
INFO:main_2:Tool Call: execute_sql_query with query: SELECT * FROM `kbc-use4-839-261b.WORKSPACE_21894820.OUT_FACT_ORDERS_5_KAPWA_GARDENS` LIMIT 10
INFO:main_2:Tool Call: query executed, returned 10 rows.
INFO:httpx:HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent "HTTP/1.1 200 OK"
INFO:google_genai.models:AFC remote call 2 is done.
INFO:main_2:Gemini final answer (genai.Client/chat): Fantastic! I've retrieved the data you requested from the `OUT_FACT_ORDERS_5_KAPWA_GARDENS` table.  Here's a look at the first 10 rows in a table:

The table includes columns such as `order_id`, `customer_id_fk`, `created_at_ts`, `financial_status`, `total`, `subtotal`, `discount_amount`, `shipping`, `taxes`, and many more.  Let me know if you'd like to see more data, or if you have a more specific query, like filtering the data based on a certain date range or customer ID.  I'm ready to help refine your request!

INFO:main_2:Attempting to retrieve chat history using get_history()...
INFO:main_2:Successfully called get_history(). Number of messages: 6
INFO:main_2:Found function_response in history part: internal_execute_sql_query
INFO:main_2:Function response content type: <class 'dict'>, content: {'result': {'status': 'success', 'data': [{'order_id': '4096', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '5365', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '5304', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '45', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '3872', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '1296', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '2799', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '4882', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '5694', 'customer_id_fk': '', 'channel_order_number': '', 'financial_status': '', 'paid_at_ts': None, 'fulfillment_status': '', 'fulfilled_at_ts': None, 'created_at_ts': None, 'cancelled_at_ts': None, 'currency': '', 'subtotal': None, 'shipping': None, 'taxes': None, 'amount_refunded': None, 'total': None, 'discount_code': '', 'discount_amount': None, 'shipping_method': '', 'billing_name': '', 'billing_address1': '', 'billing_address2': '', 'billing_city': '', 'billing_zip': '', 'billing_province': '', 'billing_country': '', 'billing_phone': '', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': '', 'channel_name': '', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': '', 'payment_reference': '', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}, {'order_id': '2622', 'customer_id_fk': 'dvdeocampo@gmail.com', 'channel_order_number': '2622', 'financial_status': 'PAID', 'paid_at_ts': datetime.datetime(2022, 6, 6, 20, 17, 30, tzinfo=datetime.timezone.utc), 'fulfillment_status': 'pending', 'fulfilled_at_ts': None, 'created_at_ts': datetime.datetime(2022, 6, 6, 20, 17, 30, tzinfo=datetime.timezone.utc), 'cancelled_at_ts': None, 'currency': 'USD', 'subtotal': 40.0, 'shipping': 0.0, 'taxes': 0.0, 'amount_refunded': 0.0, 'total': 35.0, 'discount_code': 'PAMILYA5', 'discount_amount': 5.0, 'shipping_method': '', 'billing_name': 'Nikki DeOcampo', 'billing_address1': '5311 Harvest Spring Drive', 'billing_address2': '', 'billing_city': 'Kingwood', 'billing_zip': '77345', 'billing_province': 'TX', 'billing_country': 'United States', 'billing_phone': '2818832633', 'shipping_name': '', 'shipping_address1': '', 'shipping_address2': '', 'shipping_city': '', 'shipping_zip': '', 'shipping_province': '', 'shipping_country': '', 'shipping_phone': '', 'private_notes': '', 'channel_type': 'ONLINE', 'channel_name': 'Squarespace', 'ca_local_tax': None, 'ca_tax': None, 'payment_method': 'Stripe', 'payment_reference': 'ch_3L7mMgB5k7LfK0Tx1OIhrFM7', 'source_website': 'Kapwa Gardens', 'order_data_loaded_at': datetime.datetime(2025, 5, 26, 22, 41, 48, 82471, tzinfo=datetime.timezone.utc), 'etl_created_at': datetime.datetime(2025, 5, 26, 22, 41, 54, 369031, tzinfo=datetime.timezone.utc), '_timestamp': datetime.datetime(2025, 5, 26, 22, 42, 17, tzinfo=datetime.timezone.utc)}]}}
INFO:main_2:Processing displays - query_data type: <class 'NoneType'>, length: N/A
INFO:main_2:Query data content preview: None
WARNING:main_2:No query_data extracted from tool calls, checking text response for table information
INFO:werkzeug:127.0.0.1 - - [29/May/2025 18:34:23] "POST /api/chat HTTP/1.1" 200 -
